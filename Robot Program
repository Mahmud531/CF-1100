#include <bits/stdc++.h>
using namespace std;

using ll = long long;

void solve(){
  ll n,x,k;
  cin>>n>>x>>k;
  string s;
  cin>>s;
  
  ll first_reach = -1;
  ll cur_pos = x;

  for(int i = 0;i<n;i++){
    if(s[i]=='L') cur_pos--;
    else cur_pos++;

    if(cur_pos==0){
        first_reach = i+1;
        break;
    }
  }

  if(first_reach == -1 || first_reach>k){
    cout<<0<<"\n";
    return;
  } 

  ll ans = 1;
  ll remain_k = k-first_reach;
  ll cycle_time = -1;
  cur_pos = 0;

  for(int i = 0;i<n;i++){
    if(s[i]=='L') cur_pos--;
    else cur_pos++;

    if(cur_pos==0){
        cycle_time = i+1;
        break;
    }
  }

  if(cycle_time != -1){
    ans+= (remain_k/cycle_time);
  }

  cout<<ans<<'\n';

}


int main() {
    ios_base::sync_with_stdio(false);
    cin.tie(NULL);
    
    int t;
    cin >> t;
    while(t--) {
        solve();
    }
    return 0;
} 
